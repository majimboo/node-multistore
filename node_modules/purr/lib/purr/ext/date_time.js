var vmDate = require('vm').runInNewContext('Date');

function DateTime() {
  if(!(this instanceof DateTime)) {
    return DateTime.apply(Object.create(DateTime.prototype), arguments);
  }

  var d = new vmDate();

  switch(arguments.length) {
    case 1:
      d = new vmDate(arguments[0]);
      break;
    case 3: case 4: case 5: case 6: case 7:
      d = new vmDate(arguments[0], arguments[1], arguments[2],
                     arguments[3] || null,
                     arguments[4] || null,
                     arguments[5] || null,
                     arguments[6] || null);
      break;
    default:
      // do nothing
  }

  d.nanoseconds = d.getMilliseconds() * 1000000;

  return d;
}

DateTime.prototype = vmDate.prototype;
DateTime.prototype.type = 3;

DateTime.prototype.getNanoseconds = function() {
  return this.nanoseconds;
}

DateTime.prototype.setNanoseconds = function(ns) {
  this.setMilliseconds(Math.floor(ns / 1000000));
  this.nanoseconds = ns;
}

exports.DateTime = DateTime;
